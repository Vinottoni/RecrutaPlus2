import{top,left,right,bottom,end}from"../enums.js";import getOffsetParent from"../dom-utils/getOffsetParent.js";import getWindow from"../dom-utils/getWindow.js";import getDocumentElement from"../dom-utils/getDocumentElement.js";import getComputedStyle from"../dom-utils/getComputedStyle.js";import getBasePlacement from"../utils/getBasePlacement.js";import getVariation from"../utils/getVariation.js";import{round}from"../utils/math.js";var unsetSides={top:"auto",right:"auto",bottom:"auto",left:"auto"};function roundOffsetsByDPR(t){var e=t.x,o=t.y,t=window.devicePixelRatio||1;return{x:round(e*t)/t||0,y:round(o*t)/t||0}}function mapToStyles(t){var e=t.popper,o=t.popperRect,s=t.placement,i=t.variation,a=t.offsets,p=t.position,r=t.gpuAcceleration,n=t.adaptive,l=t.roundOffsets,m=t.isFixed,f=!0===l?roundOffsetsByDPR(a):"function"==typeof l?l(a):a,d=f.x,u=void 0===d?0:d,c=f.y,g=void 0===c?0:c,y=a.hasOwnProperty("x"),v=a.hasOwnProperty("y"),t=left,l=top,d=window;n&&(f="clientHeight",c="clientWidth",(a=getOffsetParent(e))===getWindow(e)&&(a=getDocumentElement(e),"static"!==getComputedStyle(a).position&&"absolute"===p&&(f="scrollHeight",c="scrollWidth")),s!==top&&(s!==left&&s!==right||i!==end)||(l=bottom,g-=(m&&d.visualViewport?d.visualViewport.height:a[f])-o.height,g*=r?1:-1),s!==left&&(s!==top&&s!==bottom||i!==end)||(t=right,u-=(m&&d.visualViewport?d.visualViewport.width:a[c])-o.width,u*=r?1:-1));var n=Object.assign({position:p},n&&unsetSides);return r?Object.assign({},n,((r={})[l]=v?"0":"",r[t]=y?"0":"",r.transform=(d.devicePixelRatio||1)<=1?"translate("+u+"px, "+g+"px)":"translate3d("+u+"px, "+g+"px, 0)",r)):Object.assign({},n,((n={})[l]=v?g+"px":"",n[t]=y?u+"px":"",n.transform="",n))}function computeStyles(t){var e=t.state,o=t.options,s=o.gpuAcceleration,t=void 0===s||s,s=o.adaptive,s=void 0===s||s,o=o.roundOffsets,o=void 0===o||o,t={placement:getBasePlacement(e.placement),variation:getVariation(e.placement),popper:e.elements.popper,popperRect:e.rects.popper,gpuAcceleration:t,isFixed:"fixed"===e.options.strategy};null!=e.modifiersData.popperOffsets&&(e.styles.popper=Object.assign({},e.styles.popper,mapToStyles(Object.assign({},t,{offsets:e.modifiersData.popperOffsets,position:e.options.strategy,adaptive:s,roundOffsets:o})))),null!=e.modifiersData.arrow&&(e.styles.arrow=Object.assign({},e.styles.arrow,mapToStyles(Object.assign({},t,{offsets:e.modifiersData.arrow,position:"absolute",adaptive:!1,roundOffsets:o})))),e.attributes.popper=Object.assign({},e.attributes.popper,{"data-popper-placement":e.placement})}export default{name:"computeStyles",enabled:!0,phase:"beforeWrite",fn:computeStyles,data:{}};export{mapToStyles};